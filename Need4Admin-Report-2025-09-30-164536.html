<!DOCTYPE html>
<html>
<head>
<title>Need4Admin - Privileged Users Report</title>
<style>
body{font-family:'Segoe UI',Arial,sans-serif;margin:20px;background-color:#f5f5f5;color:#333;}
.header{background-color:#0078d4;color:white;padding:20px;border-radius:5px;margin-bottom:20px;}
.summary{background-color:white;padding:15px;border-radius:5px;margin-bottom:20px;box-shadow:0 2px 4px rgba(0,0,0,0.1);}
.summary-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:15px;}
.summary-item{text-align:center;padding:10px;background-color:#f8f9fa;border-radius:3px;}
.summary-number{font-size:24px;font-weight:bold;color:#0078d4;}.summary-label{font-size:12px;color:#666;margin-top:5px;}
.azure-summary{color:#ff6600;}.phishing-resistant{color:#28a745;}
.search-container{background-color:white;padding:15px;border-radius:5px;margin-bottom:20px;box-shadow:0 2px 4px rgba(0,0,0,0.1);}
.search-box{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;box-sizing:border-box;}
.search-box:focus{outline:none;border-color:#0078d4;box-shadow:0 0 0 2px rgba(0,120,212,0.1);}
.search-info{margin-top:10px;font-size:12px;color:#666;}
table{width:100%;border-collapse:collapse;background-color:white;border-radius:5px;overflow:hidden;box-shadow:0 2px 4px rgba(0,0,0,0.1);font-size:13px;}
th{background-color:#f8f9fa;padding:10px 8px;text-align:left;font-weight:600;border-bottom:2px solid #dee2e6;cursor:pointer;user-select:none;}
th:hover{background-color:#e9ecef;}
td{padding:8px;border-bottom:1px solid #dee2e6;vertical-align:top;}
tr:hover{background-color:#f8f9fa;}
tr.hidden{display:none;}
.status-active{color:#28a745;font-weight:bold;}.status-disabled{color:#dc3545;font-weight:bold;}
.type-hybrid{color:#fd7e14;font-weight:bold;}.type-cloud{color:#0078d4;font-weight:bold;}
.mfa-yes{color:#28a745;font-weight:bold;}.mfa-no{color:#dc3545;font-weight:bold;}
.auth-method-phishing-resistant{color:#28a745;font-weight:bold;}
.via-group{color:#0078d4;font-weight:bold;}
.footer{margin-top:20px;text-align:center;color:#666;font-size:12px;}
.scroll-container{overflow-x:auto;}
.sortable th::after{content:' â†•';color:#aaa;font-size:10px;}
</style>
</head>
<body>
<div class='header'>
<h1>Need4Admin - Privileged Users Report</h1>
<p>Generated on: 2025-09-30 16:45:36 | Tenant: 1282beb5-d753-4653-b5de-2f386252e026 | Signed in as: admin@M365x97424027.onmicrosoft.com</p>
</div>
<div class='summary'><div class='summary-grid'>
<div class='summary-item'><div class='summary-number'>6</div><div class='summary-label'>Total Users</div></div>
<div class='summary-item'><div class='summary-number'>6</div><div class='summary-label'>Active Users</div></div>
<div class='summary-item'><div class='summary-number'>0</div><div class='summary-label'>Hybrid Users</div></div>
<div class='summary-item'><div class='summary-number'>6</div><div class='summary-label'>Entra Active Roles</div></div>
<div class='summary-item'><div class='summary-number'>0</div><div class='summary-label'>Entra Eligible Roles</div></div>
<div class='summary-item'><div class='summary-number azure-summary'>0</div><div class='summary-label'>Azure Active Roles</div></div>
<div class='summary-item'><div class='summary-number azure-summary'>0</div><div class='summary-label'>Azure Eligible Roles</div></div>
<div class='summary-item'><div class='summary-number'>5</div><div class='summary-label'>Without MFA</div></div>
<div class='summary-item'><div class='summary-number phishing-resistant'>0</div><div class='summary-label'>Phishing-Resistant Auth</div></div>
</div></div>
<div class='search-container'>
<input type='text' id='searchBox' class='search-box' placeholder='Search users, roles, status... (e.g., Global Administrator, via group, Active, No MFA)'>
<div class='search-info' id='searchInfo'>Showing all 6 users</div>
</div>
<div class='scroll-container'>
<table class='sortable' id='dataTable'>
<thead>
<tr>
<th onclick='sortTable(0)'>UPN</th>
<th onclick='sortTable(1)'>Entra Active Roles</th>
<th onclick='sortTable(2)'>Entra Eligible Roles</th>
<th onclick='sortTable(3)'>Azure Active Roles</th>
<th onclick='sortTable(4)'>Azure Eligible Roles</th>
<th onclick='sortTable(5)'>Total</th>
<th onclick='sortTable(6)'>Status</th>
<th onclick='sortTable(7)'>Type</th>
<th onclick='sortTable(8)'>MFA</th>
<th onclick='sortTable(9)'>Last Interactive Sign In</th>
<th onclick='sortTable(10)'>Last Non-Interactive Sign In</th>
<th onclick='sortTable(11)'>Auth Methods</th>
</tr>
</thead>
<tbody>
<tr>
<td>MeganB@M365x97424027.OnMicrosoft.com</td>
<td><span style='color:#dc3545;font-weight:bold;'>Global Administrator</span></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>1</td>
<td class='status-active'>Active</td>
<td class='type-cloud'>Cloud</td>
<td class='mfa-no'>No</td>
<td>2025-08-05 01:55</td>
<td>2025-08-05 02:02</td>
<td>None</td>
</tr>
<tr>
<td>IsaiahL@M365x97424027.OnMicrosoft.com</td>
<td><span style='color:#dc3545;font-weight:bold;'>Global Administrator</span></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>1</td>
<td class='status-active'>Active</td>
<td class='type-cloud'>Cloud</td>
<td class='mfa-no'>No</td>
<td>2025-08-05 01:18</td>
<td>2025-08-05 00:37</td>
<td>None</td>
</tr>
<tr>
<td>AllanD@M365x97424027.OnMicrosoft.com</td>
<td><span style='color:#dc3545;font-weight:bold;'>Global Administrator</span></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>1</td>
<td class='status-active'>Active</td>
<td class='type-cloud'>Cloud</td>
<td class='mfa-no'>No</td>
<td>2025-08-05 01:16</td>
<td>2025-08-05 00:56</td>
<td>None</td>
</tr>
<tr>
<td>admin@M365x97424027.onmicrosoft.com</td>
<td><span style='color:#dc3545;font-weight:bold;'>Global Administrator</span></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>1</td>
<td class='status-active'>Active</td>
<td class='type-cloud'>Cloud</td>
<td class='mfa-yes'>Yes</td>
<td>2025-09-28 12:19</td>
<td>2025-09-29 13:19</td>
<td>microsoftAuthenticatorPush, softwareOneTimePasscode</td>
</tr>
<tr>
<td>NestorW@M365x97424027.OnMicrosoft.com</td>
<td><span style='color:#dc3545;font-weight:bold;'>Global Administrator</span></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>1</td>
<td class='status-active'>Active</td>
<td class='type-cloud'>Cloud</td>
<td class='mfa-no'>No</td>
<td>2025-08-05 01:20</td>
<td>2025-08-05 00:56</td>
<td>None</td>
</tr>
<tr>
<td>LidiaH@M365x97424027.OnMicrosoft.com</td>
<td><span style='color:#dc3545;font-weight:bold;'>Global Administrator</span></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>1</td>
<td class='status-active'>Active</td>
<td class='type-cloud'>Cloud</td>
<td class='mfa-no'>No</td>
<td>2025-08-05 00:32</td>
<td>2025-08-05 00:56</td>
<td>None</td>
</tr>
</tbody>
</table>
</div>
<script>
let currentSortColumn=-1;let sortAscending=true;
function sortTable(columnIndex){
    const table=document.getElementById('dataTable');
    const tbody=table.getElementsByTagName('tbody')[0];
    const rows=Array.from(tbody.getElementsByTagName('tr')).filter(row=>!row.classList.contains('hidden'));
    
    if(currentSortColumn===columnIndex){
        sortAscending=!sortAscending;
    }else{
        sortAscending=true;
        currentSortColumn=columnIndex;
    }
    
    rows.sort((a,b)=>{
        const aText=a.cells[columnIndex].textContent.trim();
        const bText=b.cells[columnIndex].textContent.trim();
        const aNum=parseFloat(aText);
        const bNum=parseFloat(bText);
        
        if(!isNaN(aNum)&&!isNaN(bNum)){
            return sortAscending?aNum-bNum:bNum-aNum;
        }else{
            return sortAscending?aText.localeCompare(bText):bText.localeCompare(aText);
        }
    });
    
    // Re-append all rows (including hidden ones) in sorted order
    const allRows=Array.from(tbody.getElementsByTagName('tr'));
    allRows.forEach(row=>{
        if(!row.classList.contains('hidden')){
            tbody.removeChild(row);
        }
    });
    rows.forEach(row=>tbody.appendChild(row));
}

// Search functionality
document.getElementById('searchBox').addEventListener('input', function(e) {
    const searchTerm = e.target.value.toLowerCase();
    const table = document.getElementById('dataTable');
    const tbody = table.getElementsByTagName('tbody')[0];
    const rows = tbody.getElementsByTagName('tr');
    let visibleCount = 0;
    
    for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const text = row.textContent.toLowerCase();
        
        if (searchTerm === '' || text.includes(searchTerm)) {
            row.classList.remove('hidden');
            visibleCount++;
        } else {
            row.classList.add('hidden');
        }
    }
    
    // Update search info
    const searchInfo = document.getElementById('searchInfo');
    if (searchTerm === '') {
        searchInfo.textContent = 'Showing all ' + rows.length + ' users';
    } else {
        searchInfo.textContent = 'Showing ' + visibleCount + ' of ' + rows.length + ' users';
    }
});</script>
<div class='footer'><p>Need4Admin - Microsoft Privileged User Scanner v1.0 | Author: Vlad Johansen, 2025</p></div>
</body>
</html>
